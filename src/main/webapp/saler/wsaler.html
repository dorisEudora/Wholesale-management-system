<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>批发商信息页面</title>
<style>
.td_header{
   background-color: #E0FFFF;
   color: #000000;
   FONT-SIZE: 18pt;
}

.up{
   background-color: #90EE90;
   color: #FFFFFF;
   cursor: hand;
}

#frm{
   width: 500px;
   height: 200px;
   FONT-SIZE: 13pt;
}
</style>
<script type="text/javascript" src="../js/jquery-1.11.3.min.js"></script>
</head>
<script type="text/javascript">
$(document).ready( function(){ getList(); } );

function getList(){
	document.getElementById("refactor").style.display = "none";
	$.get("../WsalerListAction",function(data){ WriteList(data); },"JSON");
}

function WriteList(data){
	var wsaler=eval(data);
	var htmlstr="<table border=1 width=60% align=center>";
	for(i=0;i<wsaler.length;i++){
		htmlstr+="<tr>";
		htmlstr+="<td width=15%>"+wsaler[i]["Wno"]+"</td>";
		htmlstr+="<td width=15%>"+wsaler[i]["Wname"]+"</td>";
		htmlstr+="<td width=15%>"+wsaler[i]["Tel"]+"</td>";
		htmlstr+="<td width=15%>"+wsaler[i]["Loc"]+"</td>";

		htmlstr+="<td><a href=\"JavaScript:show_input("+wsaler[i]["Id"]+")\">编辑</a>";
		htmlstr+="<a href=\"JavaScript:delData("+wsaler[i]["Id"]+")\">删除</a></td>";	
		htmlstr+="</tr>";
	}
	htmlstr+="</table>";
	$("#wsalerlist").html(htmlstr);
}

function delData(Id){
	$.ajax({
		type:"POST",
		data:{"Id":Id},
		url:"../WsalerDelAction",
		success:function(data){
		    if(data=="0"){ 
		      	 alert("删除失败"); 
		    }else{   
		    	alert("删除成功!");
		        getList();	 //刷新列表
		    }
		},
		error:function(){
			alert("删除请求失败");
		}		
	});
}

function show_input(Id){
	document.getElementById("refactor").style.display = "block";
	if(Id!=-1){
		$('#frmTitle').text("批发商信息修改");
		$.get("../WsalerGetAction?Id="+Id,			//servlet
				function(data) { ShowData(eval(data)); },	//JSON数据处理函数
				"JSON");									//JSON		
	}else{
		$('#frmTitle').text("批发商信息添加");
		$("#Id").val(-1);
		$("#Wno").val("");
		$("#Wname").val("");
		$("#Tel").val("");
		$("#Loc").val("");

	}
}

function ShowData(wsaler){
	$("#Id").val(wsaler["Id"]);
	$("#Wno").val(wsaler["Wno"]);
	$("#Wname").val(wsaler["Wname"]);
	$("#Tel").val(wsaler["Tel"]);
	$("#Loc").val(wsaler["Loc"]);

}

function check(){
	var re = /^[0-9]{3,20}$/;
	if(!re.test($("#Wno").val())){
		alert("请输入数字组成的批发商编号!");
		$("#Wno").focus();
		return ;
	}
	re = /^\S{3,20}$/;
	if(!re.test($("#Wname").val()) ){
		alert("请输入3~20字符的批发商姓名!");
		$("#Wname").focus();
		return;
	}
	re = /^\S{3,20}$/;
	if(!re.test($("#Tel").val()) ){
		alert("请输入3~20字符的批发商电话!");
		$("#Tel").focus();
		return;
	}
	re = /^\S{3,20}$/;
	if(!re.test($("#Loc").val()) ){
		alert("请输入3~20字符的批发商地址!");
		$("#Loc").focus();
		return;
	}
	
	$.ajax({
		type: "POST",
		url:"../WsalerUpdateAction",
		data:$("#frm").serialize() ,
	    error: function() {
	        alert("请求失败！");
	    },
	    success: function(data) {
		    if(data=="0"){ 
		    	alert("数据处理不成功"); 
		    }else{
		    	alert("数据处理成功!");
		    	getList();
		    }
	    }
	});
}
</script>
<body>

<table border="1" width=60% align="center">
<tr><td class="td_header" colspan="7" align="center">批发商信息列表</td></tr>
<tr align="center">
	<td width=15%>批发商编号</td><td width=15%>批发商商名</td><td width=15%>批发商电话</td>
	<td width=15%>批发商地址</td>
</tr>
</table>  
<div id="wsalerlist"></div>	
<br><br>
		<table width="60%"  border="0" cellpadding="0" cellspacing="0" align="center">	
			<tr><td colspan="5"><a href="JavaScript:show_input(-1);">添加批发商信息</a>
				<td colspan="5"><a href="JavaScript:getList();">刷新数据列表</a>
			</tr>
		</table>
		<br><br>
<div id="refactor">
<form name=frm id=frm action="../WsalerUpdateAction">
<input type=hidden name=Id id=Id value="-1">
<span id="frmTitle">批发商信息添加</span> （* 为必填项）<br>
批发商编号<input type=text name=Wno id=Wno value="" style="height:20px;width:200px;">*数字组成的编号<br>
批发商商名<input type=text name=Wname id=Wname value="" style="height:20px;width:200px;">*<br>
批发商电话<input type=text name=Tel id=Tel value="" style="height:20px;width:200px;">*<br>
批发商地址<input type=text name=Loc id=Loc value="" style="height:20px;width:200px;">*3~20个字符<br>

<input class="up" type=button value="提交" onclick="check();">
<input class="up" type=reset value="重置">
</form>
</div>

</body>
</html>